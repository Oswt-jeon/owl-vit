# OWL-ViT 실험 프로젝트

OWL-ViT(OWL-V2) 모델을 이용해 쿼리 이미지와 유사한 객체를 타깃 이미지에서 탐지하는 실험용 프로젝트입니다.

## 기본 실행 방법

```bash
python run_owlvit.py \
  --target images/target5.jpeg \
  --query images/query5.jpeg \
  --output images/result.jpg
```

명령이 성공하면 결과 이미지는 `--output` 으로 지정한 경로에 저장되고, 터미널에는 탐지 수와 점수가 출력됩니다.

## 주요 옵션 설명

- `--score-thresh`  
  1차 점수 임계값(기본 0.45). 낮출수록 더 많은 후보 박스를 남겨 추가 필터링을 받습니다.

- `--dyn-alpha` / `--skip-dyn`  
  남은 박스들의 평균·표준편차를 활용해 `mean + alpha × std` 만큼 추가 컷을 적용합니다. 값을 낮추거나 `--skip-dyn`을 주면 더 많은 박스를 유지합니다.

- `--scales`  
  콤마로 구분된 스케일 팩터 목록. 예: `--scales "1.0,1.3,1.6"`  
  각 스케일별로 타깃 이미지를 리사이즈한 뒤 추론하여 작은 객체도 놓치지 않도록 합니다.

- `--base-long-side`  
  추론 전에 타깃 이미지의 긴 변을 해당 길이에 맞춘 뒤 `--scales` 를 적용합니다. 고해상도 이미지를 통째로 키우고 싶을 때 유용합니다.

- `--min-area-ratio`, `--max-ar`  
  최소 면적 비율과 허용 종횡비를 지정해 지나치게 작은 박스나 가늘고 긴 박스를 제거합니다.

- `--radius-nms`, `--topk`  
  중심 거리 기반 억제 반경과 최종 박스 상한(K)을 지정합니다. 중복 박스를 줄이고 최종 후보 수를 제한할 때 사용합니다.

- `--verbose`  
  스케일별 후보 수와 상위 점수를 로그로 출력해 튜닝 지표로 활용할 수 있습니다.

## 튜닝 팁

1. 작은 물체가 잘 잡히지 않을 때  
   `--scales` 에 1보다 큰 값을 추가하고, 필요하면 `--base-long-side` 로 기본 해상도를 키워 보세요.

2. 너무 많은 오검출이 발생할 때  
   `--score-thresh` 를 올리고 `--dyn-alpha` 값을 키우거나 `--radius-nms` 를 늘려 중심이 비슷한 박스를 제거합니다.

3. 탐지가 하나도 나오지 않을 때  
   `--score-thresh` 를 낮추고, `--dyn-alpha` 를 0 근처로 두거나 `--skip-dyn` 을 적용해 후보를 더 살립니다.

필요에 따라 위 옵션들을 조합하며 프로젝트 상황에 가장 잘 맞는 파이프라인을 구성하세요. `--verbose` 로 로그를 확인하면 각 설정이 어떤 영향을 주는지 빠르게 파악할 수 있습니다.
